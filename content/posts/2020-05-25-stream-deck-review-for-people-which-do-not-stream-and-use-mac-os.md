---
title: >-
  Stream Deck review for people who do not play games or stream and use macOS
slug: /stream-deck-review-people-stream-macos-extensibility/
author: Elio Struyf
type: post
date: 2020-05-28T19:49:32.520Z
draft: false
tags:
  - Development
  - Stream Deck
  - Elgato
  - Microsoft Teams
categories: []
comments: true
---

During the Corona crisis, most of us had to work from home. One of the devices I saw people making a lot of fuss about was the [Elgato Stream Deck](https://www.elgato.com/en/gaming/stream-deck). As the name suggests, it intends to make streaming easier to give you a set of buttons you can use for quickly triggering actions.

These actions can be different things like switching scenes, cameras, hotkeys/shortcuts, and many more.

{{< caption-new "/uploads/2020/05/elgato1.jpg" "Stream Deck buttons configured for my daily work"  "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAgACgMBEQACEQEDEQH/xAGiAAABBQEBAQEBAQAAAAAAAAAAAQIDBAUGBwgJCgsQAAIBAwMCBAMFBQQEAAABfQECAwAEEQUSITFBBhNRYQcicRQygZGhCCNCscEVUtHwJDNicoIJChYXGBkaJSYnKCkqNDU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6g4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2drh4uPk5ebn6Onq8fLz9PX29/j5+gEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoLEQACAQIEBAMEBwUEBAABAncAAQIDEQQFITEGEkFRB2FxEyIygQgUQpGhscEJIzNS8BVictEKFiQ04SXxFxgZGiYnKCkqNTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqCg4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2dri4+Tl5ufo6ery8/T19vf4+fr/2gAMAwEAAhEDEQA/APy1/aV+Jngnwt8TPGNh40srfxA2k+N/Htpreizy/tA3via61HZPp1rc6sbAnwvb6hY6qJluYtNv7ZY2ivYZYFgdIZ/2irPh6vleAwuU4XCZfnPJOWMzfiZZpWyPkjhsI6ap0eHZ180dSpUp4xUWsLUhHEV8JKtbDxruGUsnWGyVY7C8W5DiczxFdVHk2MwmerEYKEp0PaUJVYZLh8BKMKU6qpeyx1eXtKNVzqVISoup4npHgn9qHxBpOl694b+CfxZfw9renWWr6C8Vj41ETaLqVtFeaW0YdWYRtYzQFAzMwUgFicmvzermmPpValJSdZUqk6arYaVaOGqqEnH2mHWIprEKhO3NSVdKsqbiqqU+ZExy6DjF1Pqzm4pzcab5XNq8nHmalyt3tzJSturn/9k=" "700" >}}

Before I bought it, I read and saw a couple of reviews. As I am not a gamer/streamer, I wanted to make sure it would be a useful device to put on my desk. Many of these reviews focus on the device its primary intention and are maybe a bit too positive. That is why I wanted to make a review myself from a none streaming background and using it on macOS.

## The good

One of the best things is the device its customizability. You can specify what each of these buttons is doing via the Stream Deck application.

{{< caption-new "/uploads/2020/05/elgato2.png" "Stream Deck application interface"  "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAHCAYAAAAxrNxjAAAAAklEQVR4AewaftIAAACySURBVG3BMUoDQRiG4fff749ICpFsCsUmkBPkGIIn8XZWXsHCwksEVkR2C5nZYSYZHY1g4fPYzfXV/apf385zopELA8rhgGFYZ4zj+Oh02vlicddvNgQJq0eIMz4MuDtNCGHo+FJKYVnXXIYL4vkH8yrS1FqRROOcbN/29GdLXt7F6xwpAjMj50zjnDzFASI/xDd3J+dM0/GHJCTxK5Ujkiil4NM0PcQY9/yj1ookUkrPn52VR6C4ZKHYAAAAAElFTkSuQmCC" "1269" >}}

The application allows other products/applications to integrate their actions, such as OBS Studio and many others.

{{< caption-new "/uploads/2020/05/elgato3.png" "External application integrations"  "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAJCAYAAAALpr0TAAAAAklEQVR4AewaftIAAADgSURBVHXBPU4CURSG4ffcnJk7gwJ29kBhrYtwBa7A5bkMY+kS7CRWoAYkOfNzPzMFiY3PY1fz+f1svniQhJmxWC7oogMDFTHZ7XdPXrft7WazfjydTnRdR0qJJmfOcs4cj4e3NJu1rDYrSilIYhIRRAQRQUQgCR++vvl5fiEtl7g7dV1jZkjCzDAzJOFj23JYr4ntlokkIoKzqqqYeOk62H9iZkjCzGiaBkmUUkgpYWb4RRHXgg8z+r5nGAb+yjkzScfKeV9cMo4j7o6785ck3B1z95uqqu74R0qJvu9ffwHr/2hZSe9PiQAAAABJRU5ErkJggg==" "952" >}}

Another great functionality is the ability to create profiles. You can use these profiles for specific applications. For instance, for *Photoshop*, automatically show all your *Photoshop* shortcuts.

{{< caption-new "/uploads/2020/05/elgato4.png" "Stream Deck profiles per application"  "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAGCAYAAAD68A/GAAAAAklEQVR4AewaftIAAACZSURBVH3BPU7DQBCA0W9m7cXClE5Ll5ISiUNwCLpcKzfhABGHoEBKh5t40f7MEBfuorwn4zi+7abpw90ZhoGUErhjZmx+5/nY9Q+PL8P+/VCaE/M3T39nNiJCa41LSl8dVpGfTyLQVMiqqCqh76mlYGa4Ox044KwEIcaIqlJKwcyotbLquBIR3J3VsizcIiGE5xjjK3fknE//nsNBmqR5emQAAAAASUVORK5CYII=" "824" >}}

## The bad

Some good things also come with the bad side. I wanted to use the Stream Deck with a couple of actions I saw that were possible. Like playing/pausing Spotify, muting my micro, enabling/disabling my camera. When I started the installation and configuration, I noticed these actions for Spotify, for instance, were not available. Most of all, the external integrations are created for Windows. That, for me, is one of the most significant downsides.

Something else that bothered me has nothing to do with the device and functionality itself. As I am always working from home (not because of the Corona crisis), I wanted to take control of my meetings so that I can easily change my volume, toggle the microphone mute and toggle the camera. Although this might sound like simple actions, none of them were there are fit my needs.

For instance, you have multimedia actions, but these toggle play/pause of the currently active window if something is playing in it. If not, it will toggle it on what is playing on the background. This functionality is a bit frustrating, for instance, when listening to music, and going to Youtube with your browser. When you click on the play/pause action, it stops Youtube instead of stopping the music.

My camera and microphone were only configurable if I used OBS studio. It seems that there is no internal action to enable/disable that from Stream Deck.

## The ugly

As I wanted to make the device as useful as possible to fit my needs, I thought to start creating my plugin.

> **Info**: You can find documentation for creating your own plugin here: [https://developer.elgato.com/documentation/stream-deck/sdk/create-your-own-plugin/](https://developer.elgato.com/documentation/stream-deck/sdk/create-your-own-plugin/).

At first, I was not impressed at all with the development guidance. To create your plugin, you need to start from an existing plugin. It would be better to have a template/blueprint of an empty plugin to start.

Another issue I had was that if you choose to create a JavaScript plugin, it will only be browser-based. Which means you cannot use any Node.js scripts/functionality. This limitation is cumbersome, as this way limits the functionality to, for instance, toggle my microphone, camera, and so on.

Something else that bothered me was the integration with the Elgato Key Lights. If you own Key Lights (which are great by the way), to control them via your Stream Deck, you need both the Control Center application and the actions installed. The control center application needs to be running, as well. Otherwise, you cannot control your lights. As I own two lights, they both need to be set to the same setting, changing brightness/temperature. Luckily Elgato thought about this, and there is a synchronize setting. If you do something to one light, it will also get set to the other, but for some reason, this not always worked as expected.

As I wanted to check what was going on, I started checking the API calls the Control Center application performed. 

{{< caption-new "/uploads/2020/05/elgato5.png" "Key Light API calls"  "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAFCAYAAAB8ZH1oAAAAAklEQVR4AewaftIAAABySURBVH3BwQ2EMBAEwZ4Vxt4ICIT84yEAJIQAj9E9+F6V1nUdmcm2bXyWZWHfd1przPOMbaYxBraRxMc2kui903vHNlFKITPJTCQREdRaiQhKKbTWqLUy3ffNeZ4cx8GPJK7r4nkeIoKIwDYhiX8kIYkXSzIu6wjT63QAAAAASUVORK5CYII=" "544" >}}

That is when I saw the application was calling each light its API every 10ms. At that point, I decided to write a plugin myself, which does what I want it to do and not have to run additional applications.

## Configuring it to my needs

I wanted to have the following actions:

- Control my key lights
- Turning the temperature of the key lights up and down
- Turning the brightness of the key lights up and down
- Controlling Spotify
- Volume controls
- Microsoft Teams microphone and camera controls
- Other light controls in my office

{{< caption-new "/uploads/2020/05/elgato1.jpg" "Stream Deck buttons configured for my daily work"  "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAgACgMBEQACEQEDEQH/xAGiAAABBQEBAQEBAQAAAAAAAAAAAQIDBAUGBwgJCgsQAAIBAwMCBAMFBQQEAAABfQECAwAEEQUSITFBBhNRYQcicRQygZGhCCNCscEVUtHwJDNicoIJChYXGBkaJSYnKCkqNDU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6g4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2drh4uPk5ebn6Onq8fLz9PX29/j5+gEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoLEQACAQIEBAMEBwUEBAABAncAAQIDEQQFITEGEkFRB2FxEyIygQgUQpGhscEJIzNS8BVictEKFiQ04SXxFxgZGiYnKCkqNTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqCg4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2dri4+Tl5ufo6ery8/T19vf4+fr/2gAMAwEAAhEDEQA/APy1/aV+Jngnwt8TPGNh40srfxA2k+N/Htpreizy/tA3via61HZPp1rc6sbAnwvb6hY6qJluYtNv7ZY2ivYZYFgdIZ/2irPh6vleAwuU4XCZfnPJOWMzfiZZpWyPkjhsI6ap0eHZ180dSpUp4xUWsLUhHEV8JKtbDxruGUsnWGyVY7C8W5DiczxFdVHk2MwmerEYKEp0PaUJVYZLh8BKMKU6qpeyx1eXtKNVzqVISoup4npHgn9qHxBpOl694b+CfxZfw9renWWr6C8Vj41ETaLqVtFeaW0YdWYRtYzQFAzMwUgFicmvzermmPpValJSdZUqk6arYaVaOGqqEnH2mHWIprEKhO3NSVdKsqbiqqU+ZExy6DjF1Pqzm4pzcab5XNq8nHmalyt3tzJSturn/9k=" "700" >}}

I choose to create all of these actions within a self-created plugin, but this meant I had to come up with a way around the limitation of running Node.js tasks.

### Running Node.js tasks from your Stream Deck plugin

I came up with an API to my [Spotify Tray Player](https://github.com/estruyf/spotify-tray-player-electron). This player is an Electron app that I use daily. 

This API doesn't necessarily need to run in an electron app. It can also just be a service. 

I am not going into details how this I developed this, as it is a bit too specific, and might not work on another device/environment. Instead, I will highlight what each button does and give you some code samples.

## What does each button do

In this section, I will go over each button group and tell more about what and how they work.

### Key light controls

{{< caption-new "/uploads/2020/05/elgato6.jpg" "Key lights enabled on the Stream Deck"  "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAgACgMBEQACEQEDEQH/xAGiAAABBQEBAQEBAQAAAAAAAAAAAQIDBAUGBwgJCgsQAAIBAwMCBAMFBQQEAAABfQECAwAEEQUSITFBBhNRYQcicRQygZGhCCNCscEVUtHwJDNicoIJChYXGBkaJSYnKCkqNDU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6g4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2drh4uPk5ebn6Onq8fLz9PX29/j5+gEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoLEQACAQIEBAMEBwUEBAABAncAAQIDEQQFITEGEkFRB2FxEyIygQgUQpGhscEJIzNS8BVictEKFiQ04SXxFxgZGiYnKCkqNTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqCg4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2dri4+Tl5ufo6ery8/T19vf4+fr/2gAMAwEAAhEDEQA/APhb9r3xn4h8I/GP4zeH/FXgDxd40OmeI4J/C9hqGkfGnUtcu1vhDc2F5ZLpNrfeBNJlXw9qmy1utPay2WLCImXUDIa/RMqlwhiuFKLlgpS4ixUVJ5lnmMzx5dhqccRJtVMFkmbYXEVKv1eKpcqptKrJzk/dfNxY7J8VChOtguMsPleNwtSVOOSYbJcBiY4qD9rT5njMbwrjuT3nSxMZLNLOjGVJQU5RjT8Gh+En7YviGKLX/Cn7P/xWsvC2uRprHhqzTwv4tKWmgamovdGtUN1Kl0Vg06e2iU3KLcYQecqybgPxzMsbmdHMcfRw2YYieHpY3FU6E8DXxtLBSowr1I0pYOlj/a46nhZQUXh6eNq1MXCk4RxFSdZTk/q8BhcIsDgljcPl2KxiwmGWLxM8LTjPEYn2MPb15xorD0VKtV56klSoUaacmoUacbQj/9k=" "700" >}}

For my Key Lights, I choose to add a toggle button on the left to turn them ON/OFF. The other buttons are there for controlling the light temperature and brightness.

The highlighted button in the middle shows the current temperature and brightness state. That way, I know when I can stop pressing the buttons.

These buttons are controlled by directly calling the Key Lights API. Each Key Light API runs on `https://<ip>:9123/elgato/lights`.

Once you have your IPs, you can call the API via a `GET` request to know their current state, and with a `PUT` request, you can set their brightness, temperature, and ON/OFF state.

```json
{
	"lights": [{
		"brightness": 50 // 0 - 100
		"temperature": 155  // 143 min. - 344 max.
		"on": 1 // 1 or 0
	}]
}
```

Here is a movie of how it works:

{{< caption-new "/uploads/2020/05/elgato10.gif" "Key lights buttons in action" >}}

### Spotify

To control Spotify, I choose to make use of the application I already had in place and added some extra API endpoints to control it from Stream Deck.

The application itself makes use of AppleScript to control the Spotify client. That way, you do not need to connect to any API.

**Info**: If you want to know how this works, please feel free to check out the following solution: [Spotify Tray Player](https://github.com/estruyf/spotify-tray-player-electron).

### Volume controls

{{< caption-new "/uploads/2020/05/elgato7.jpg" "Volume turned on"  "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAgACgMBEQACEQEDEQH/xAGiAAABBQEBAQEBAQAAAAAAAAAAAQIDBAUGBwgJCgsQAAIBAwMCBAMFBQQEAAABfQECAwAEEQUSITFBBhNRYQcicRQygZGhCCNCscEVUtHwJDNicoIJChYXGBkaJSYnKCkqNDU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6g4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2drh4uPk5ebn6Onq8fLz9PX29/j5+gEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoLEQACAQIEBAMEBwUEBAABAncAAQIDEQQFITEGEkFRB2FxEyIygQgUQpGhscEJIzNS8BVictEKFiQ04SXxFxgZGiYnKCkqNTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqCg4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2dri4+Tl5ufo6ery8/T19vf4+fr/2gAMAwEAAhEDEQA/APzM/aa8X+HtA+LXj+y8XaVceJ7vQvEXxItr7QLtf2hdX8ZX+tPrGsaRoxuDpd7c+FrHVbSOWG6b+yptO0d9JhKXCy3Ms0c/67LF8N1cowGEyvL4YTPZ0ZRxmb8RrNZZBTcIuanCnkeIq5hUlUow9lh7YTljmFWk8Qlg1VkU+HVhsgq5rR4z4cxGZ1p08RTyDE0M0eNwsZY6hhauClLD5TSwjlDDKtjqbeOre5K067nbDw8KtfgZ+2D4jtrfxD4U+APxYTwtrsEOs+GkXw74sVU0DVI1vdHVVu4DdKF06e2AFyTcADEx8zdXwFbHY+nWq01UjWVOrUh7XB1K0MJV5ZOPtMLDFJYqGGnbmoRxKVeNJxVZKopI54YWDhB1Vh5VXGLqShT9x1LLncOeXNyuV3Hm961r63P/2Q==" "700" >}}

Stream Deck comes with volume controls out of the box. Instead, I still created them myself. The reason is to be able to show the current volume status.

{{< caption-new "/uploads/2020/05/elgato8.jpg" "Volume turned off"  "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAgACgMBEQACEQEDEQH/xAGiAAABBQEBAQEBAQAAAAAAAAAAAQIDBAUGBwgJCgsQAAIBAwMCBAMFBQQEAAABfQECAwAEEQUSITFBBhNRYQcicRQygZGhCCNCscEVUtHwJDNicoIJChYXGBkaJSYnKCkqNDU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6g4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2drh4uPk5ebn6Onq8fLz9PX29/j5+gEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoLEQACAQIEBAMEBwUEBAABAncAAQIDEQQFITEGEkFRB2FxEyIygQgUQpGhscEJIzNS8BVictEKFiQ04SXxFxgZGiYnKCkqNTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqCg4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2dri4+Tl5ufo6ery8/T19vf4+fr/2gAMAwEAAhEDEQA/APyS+PHj/wCHPhDxP4nj8XvpN6dI1T4gWepaN9r+NV94ov8AV47CHQtMeeGz8X/2ENUi1lp57mKCPTNPgaDU4rq3js0itn/ZcXieGcRlmCweR5aqOf1FWWLzHiinmdDh6MY4TCyc6dbJsViMZJznRzBYRrB8s8VXy+NVRoSrKju+F6+D4clm1HjHhTF4+osNiaeS4nFV/wC0aEMRXwUauClRw2XRUZ4ajiqrtOrKfNha/tKk4xg5/G9/ov7RWv315rvgb4S/Ed/BOtXdxq3g57Lwp4uls38LalM954fa0luILq4ktm0ma0MEk9zcTPEUaWeZy0jfnWIr4ulXrU5V8PUlTrVISqZfLFvATlCcoueBeMjTxbwcmubDfWqcMR7Fw9vCNTmiuKnRfs6ftqdJ1eSPtXRU/YupyrndLnSn7Nyvyc6UuW3Mk7o//9k=" "700" >}}

To control these settings, I also make use of AppleScript.

Volume up script:

```bash
set volume output volume (output volume of (get volume settings) + 5)

# Outputs the new volume number
output volume of (get volume settings)
```

Volume down script:

```bash
set volume output volume (output volume of (get volume settings) - 5)

# Outputs the new volume number
output volume of (get volume settings)
```

Toggle the volume:

```bash
set crntVolume to get volume settings
if output muted of crntVolume is false then
    set volume with output muted
else
    set volume without output muted
end if
```

Here is a movie how this works:

{{< caption-new "/uploads/2020/05/elgato11.gif" "Volume buttons in action" >}}

### Other light controls

The other light controls are Philips Hue lights. For this, I use the one and only Philips Hue integration from Stream Deck. These actions work perfectly fine and fit exactly my needs.

### Microsoft Teams actions

Last but not least, the Microsoft Teams controls. First, I configured these two controls also via a script. The issue with that is that Microsoft Teams has logic, so you and other participants cannot see when you toggle your camera or microphone.

So I invested some time into finding a solution to make it possible to control Microsoft Teams. Sadly, the only way to control it is via shortcuts. 

With the Stream Deck application, you can add hotkey actions. 

{{< caption-new "/uploads/2020/05/elgato9.png" "Hotkey action"  "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAADCAYAAACqPZ51AAAAAklEQVR4AewaftIAAABJSURBVG3BOxKAIBBEwTc4kXAj7n8XI1PKwl0/mYHd6r1fPMYYzDn5Yxtv+wEy6zKxjW2+IoLMpFwZnBFIopRCrZXWGpKQhG1eN36lF89ZJyYLAAAAAElFTkSuQmCC" "978" >}}

Great, with this, you can configure the hotkeys applicable for your operating system.

> **Info**: Find all keyboard shortcuts for Microsoft Teams here: [Microsoft Teams Shortcuts](https://support.office.com/en-us/article/keyboard-shortcuts-for-microsoft-teams-2e8e2a70-e8d8-4a19-949b-4c36dd5292d2).

But I did not use this. I yet again wrote my implementation. Why? Straightforward answer. When you want to perform a keyboard shortcut, the application needs to be active. If not, you will perform it to the currently active application.

In most cases, you are not having Microsoft Teams active, but running on your second screen instead. That is why I had to come up with yet another way to handle this issue. 

The solution was yet again, an AppleScript. The way it would work is first to activate Microsoft Teams and execute the hotkey once active.

Here is the script to toggle your microphone:

```bash
tell application "Microsoft Teams"
	 activate
	 tell application "System Events"
	 	keystroke "m" using {shift down, command down}
	 end tell
end tell
```

Here is the script to toggle your camera:

```bash
tell application "Microsoft Teams"
     activate
     tell application "System Events"
         keystroke "o" using {shift down, command down}
     end tell
end tell
```

> **Info**: To make things easier, I created an npm dependency which you can use in your Node.js API.
